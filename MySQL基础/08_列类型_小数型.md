# 小数类型

浮点型和定点型

## 浮点型

精度类型，有可能丢失精度，是以科学计数法形式存储在字节里。

科学计数法：把一个数表示成a与10的n次幂相乘的形式（1≤a<10，n为整数）

- double 双精度类型 8个字节，10^308 **15位内**准确
- Float 单精度类型 4个字节，大概10^38，**7位数(含)**以内，基本准确

### 浮点数的精度

1. 按照实际精度显示
基本语法：float
2. 按照指定精度显示
基本语法：float(M,D)

    M(精度)表示该值的总共长度，D(标度)表示小数点后面的长度
    如float(10,2),整数部分8位，小数部分2位

### 浮点数的性质

创建一个存储浮点型数据的数据表，其中第二个类型指定精度超过其本身精度。

    create table my_float(
    f1 float,
    f2 float(10,2)
    )charset utf8;
1.插入一个超出**float本身精度**的数字

    insert into my_float values(123.123,12345678.9);
结果：

    | 123.123 | 12345679.00 |第8位精度丢失，四舍五入了
2.插入一个**超出指定精度**的数

    insert into my_float values(123.1234567,123456789.00);
结果：

    ERROR 1264 (22003): Out of range value for column 'f2' at row 1
3.插入一个符合指定精度要求的最大数，但**因超出本身精度而进位导致不符合指定精度**要求的数

    insert into my_float values(123.1234567,99999999.99);
结果：

    Query OK, 1 row affected (0.09 sec)  
    //用户插入超过指定整数长度不合法，但是系统自动进位导致的，系统可以承担
4.插入**科学计数法形式**的数据

    insert into my_float values(123.1234567,10e5);
    //可以采用科学计数法存储数据

### 浮点数符号位和零填充

1. 浮点型固有符号位，且无法关闭，即**无法使用unsigned修饰**使其无符号。
2. 浮点数可以使用**zerofill修饰**，经测试，貌似只补0到7位数

### 浮点数总结

1.浮点数自身固有精度限制，最多大概7位保证精确。
2.但是浮点数可以指定比固有精度大的范围作为指定精度，这时插入的数据从第7位开始会四舍五入。
3.直接插入超过指定精度的数值会报错
4.如果因为超出固有精度导致进位，进而导致超出指定精度，这时不报错。
5.可以按照科学计数法插入数据。
6.浮点数的结算结果会很长，而且不准确。

### 浮点数的应用

浮点数通常用于保存一些数量特别大，大到可以不那么精确的数据

## 定点数

能保证数据精确的小数（小数部分可能不精确，超出长度会四舍五入）整数部分一定精确。

- Decimal

原理：系统自动根据存储数据大小分配存储空间，大概每9个数分配4个字节，同时小数和整数部分分开存储

### 定点数的精度

基本语法：decimal(M,D)  

M：总长度，不能超过65，D:小数部分长度，不能超过30
默认不指定精度时，M=10，D=0

### 定点数的性质

创建一张表，包含定点数类型字段

    create table my_decimal(
    f1 float(10,2),
    d1 decimal(10,2)
    )charset utf8;
1.插入同一数据（**超度float本身精度，但没超过指定精度**），对比定点和浮点数据类型
    insert into my_decimal values(12345678.90,12345678.90);

结果：

    | 12345679.00 | 12345678.90 |
    //定点数没有丢失精度
2.插入最大数据（**超度float本身精度会进位，进位导致超过指定精度**），对比定点和浮点数据类型

    insert into my_decimal values(99999999.99,99999999.99);
结果：

    | 100000000.00 | 99999999.99 |
3.插入一个**在指定精度范围内**定点数，小数部分超出标度。

    insert into my_decimal values(99999999.99,999999.9999);
结果：

    | 100000000.00 | 100000000.00 |
    //小数部分可输入任意长度，系统会自动截取，并四舍五入
4.插入一个**在指定精度范围内，但进位后超出指定精度范围**的最大定点数。

    insert into my_decimal values(99999999.99,99999999.999);
结果：

    ERROR 1264 (22003): Out of range value for column 'd1' at row 1
小数部分虽然截取正确长度，但导致进位，使整数部分超出长度，系统报错

### 定点数符号位和零填充

1. 定点数同整型一样，默认有符号位，可用unsigned修饰关闭
2. 定点数同整型一样，可以使用zerofill进行零填充

### 定点数总结

1. 定点数没有固有精度的限制，他的精度限制完全靠D和M指定
2. 当D实际值超出指定值时，会自动截取并四舍五入，这时会warining警告
3. 当四舍五入导致M超出指定值时，这时直接ERROR报错。

### 定点数应用

业务含义中涉及到钱的数据类型有可能使用定点数，比如区块链中的币数财产。